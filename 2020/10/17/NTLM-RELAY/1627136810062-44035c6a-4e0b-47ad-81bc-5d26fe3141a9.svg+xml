<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="549px" preserveAspectRatio="none" style="width:877px;height:549px;" version="1.1" viewBox="0 0 877 549" width="877px" zoomAndPan="magnify"><defs><filter height="300%" id="fstsd7lxq3tj0" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="38" x2="38" y1="38.2969" y2="537.1563"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="462" x2="462" y1="38.2969" y2="537.1563"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="714" x2="714" y1="38.2969" y2="537.1563"/><rect fill="#FEFECE" filter="url(#fstsd7lxq3tj0)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="15" y="22.9951">客户端</text><rect fill="#FEFECE" filter="url(#fstsd7lxq3tj0)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="432" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="439" y="22.9951">攻击端</text><rect fill="#FEFECE" filter="url(#fstsd7lxq3tj0)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="684" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="691" y="22.9951">服务端</text><rect fill="#EEEEEE" filter="url(#fstsd7lxq3tj0)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="862" x="3" y="68.8633"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="865" y1="68.8633" y2="68.8633"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="865" y1="71.8633" y2="71.8633"/><rect fill="#EEEEEE" filter="url(#fstsd7lxq3tj0)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="133" x="367.5" y="58.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="114" x="373.5" y="74.3638">NTLM relay 流程</text><path d="M467,96.4297 L467,121.4297 L522,121.4297 L522,106.4297 L512,96.4297 L467,96.4297 " fill="#FBFB77" filter="url(#fstsd7lxq3tj0)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M512,96.4297 L512,106.4297 L522,106.4297 L512,96.4297 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="473" y="113.4966">client</text><path d="M392,135.5625 L392,160.5625 L453,160.5625 L453,145.5625 L443,135.5625 L392,135.5625 " fill="#FBFB77" filter="url(#fstsd7lxq3tj0)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M443,135.5625 L443,145.5625 L453,145.5625 L443,135.5625 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="398" y="152.6294">server</text><polygon fill="#A80036" points="450,186.8281,460,190.8281,450,194.8281,454,190.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="38" x2="456" y1="190.8281" y2="190.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="45" y="185.7622">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="58" y="185.7622">发送连接请求，协商版本</text><polygon fill="#A80036" points="702,215.9609,712,219.9609,702,223.9609,706,219.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="462" x2="708" y1="219.9609" y2="219.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="469" y="214.895">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="482" y="214.895">发送连接请求，协商版本</text><polygon fill="#A80036" points="473,245.0938,463,249.0938,473,253.0938,469,249.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="467" x2="713" y1="249.0938" y2="249.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="479" y="244.0278">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="492" y="244.0278">收到请求，返回 challenge</text><polygon fill="#A80036" points="49,274.2266,39,278.2266,49,282.2266,45,278.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="43" x2="461" y1="278.2266" y2="278.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="55" y="273.1606">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="68" y="273.1606">收到请求，返回 challenge</text><polygon fill="#A80036" points="450,303.3594,460,307.3594,450,311.3594,454,307.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="38" x2="456" y1="307.3594" y2="307.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="45" y="302.2935">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="387" x="58" y="302.2935">使用自己的密码Hash对challenge加密作为response发送给服务端</text><polygon fill="#A80036" points="702,332.4922,712,336.4922,702,340.4922,706,336.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="462" x2="708" y1="336.4922" y2="336.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="469" y="331.4263">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="215" x="482" y="331.4263">使用受害者的response发送给服务端</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="714" x2="756" y1="365.625" y2="365.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="756" x2="756" y1="365.625" y2="378.625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="715" x2="756" y1="378.625" y2="378.625"/><polygon fill="#A80036" points="725,374.625,715,378.625,725,382.625,721,378.625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="721" y="360.5591">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="734" y="360.5591">服务器校验response</text><polygon fill="#A80036" points="473,403.7578,463,407.7578,473,411.7578,469,407.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="467" x2="713" y1="407.7578" y2="407.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="479" y="402.6919">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="492" y="402.6919">认证成功</text><path d="M467,420.7578 L467,445.7578 L605,445.7578 L605,430.7578 L595,420.7578 L467,420.7578 " fill="#FBFB77" filter="url(#fstsd7lxq3tj0)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M595,420.7578 L595,430.7578 L605,430.7578 L595,420.7578 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="473" y="437.8247">成功冒用受害者身份</text><polygon fill="#A80036" points="49,472.0234,39,476.0234,49,480.0234,45,476.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="43" x2="461" y1="476.0234" y2="476.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="55" y="470.9575">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="68" y="470.9575">认证失败</text><rect fill="#EEEEEE" filter="url(#fstsd7lxq3tj0)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="862" x="3" y="504.5898"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="865" y1="504.5898" y2="504.5898"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="865" y1="507.5898" y2="507.5898"/><rect fill="#EEEEEE" filter="url(#fstsd7lxq3tj0)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="133" x="367.5" y="494.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="114" x="373.5" y="510.0903">NTLM relay 流程</text></g></svg>